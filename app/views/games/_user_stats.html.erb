<%# Partial to display user stats %>
<% if user %>
  <div class="user-stats">
    <h2>User Stats for <%= user.username %></h2>
    
    <h3>Overall Stats</h3>
    <ul>
      <li>Games Completed: <%= user.games.where(status: "completed").count %></li>
      <li>Games Won: <%= user.games.where(status: "completed", won: true).count %></li>
      <li>Overall Win Rate: <%= user.win_rate %><%= "%" if user.win_rate.is_a?(Numeric) %></li>
    </ul>

    <% ['easy', 'medium', 'hard'].each do |diff| %>
      <% if user.games.where(difficulty: diff).exists? %>
        <h3><%= diff.capitalize %> Mode Stats</h3>
        <ul>
          <li>Games Completed: <%= user.games.where(difficulty: diff, status: "completed").count %></li>
          <li>Win Rate: <%= win_rate = user.win_rate(diff) %><%= "%" if win_rate.is_a?(Numeric) %></li>
          <% avg_guesses = user.average_guesses_for_wins(diff) %>
          <% if avg_guesses.is_a?(Numeric) %>
            <li>Average Guesses to Win: <%= avg_guesses %></li>
            <li>Best Win: <%= user.best_win(diff) %> guesses</li>
          <% end %>
        </ul>
      <% end %>
    <% end %>
  </div>
<% else %>
  <p>No user stats available.</p>
<% end %>
