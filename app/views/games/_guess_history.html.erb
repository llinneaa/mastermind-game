<div id="guess_history">
  <h3>Guess History</h3>
  <% if game && game.guesses.any? %>
    <table>
      <thead>
        <tr>
          <% if game.collaborative? %>
            <th>Player</th>
          <% end %>
          <th>Guess</th>
          <th>Feedback</th>
        </tr>
      </thead>
      <tbody>
        <% game.guesses.order(created_at: :asc).each do |guess| %>
          <tr>
            <% if game.collaborative? %>
              <td><%= User.find(guess.user_id).username %></td>
            <% end %>
            <td><%= guess.input_code %></td>
            <td><%= guess.feedback %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <p>Total Guesses: <%= game.guesses.count %> / 10</p>
    <% if game.status == "completed" %>
      <% if game.won? %>
        <% if game.collaborative? %>
          <% winning_guess = game.guesses.order(created_at: :asc).last %>
          <% winner = User.find(winning_guess.user_id) %>
          <p class="game-result"><%= winner.username %> cracked the code! Victory!</p>
        <% else %>
          <p class="game-result">You cracked the code! Victory!</p>
        <% end %>
      <% else %>
        <% if game.collaborative? %>
          <p class="game-result">TWO against a ROBOT and you still LOST? ðŸ¤–</p>
        <% else %>
          <p class="game-result">The computer's defense was too strong! Game Over!</p>
        <% end %>
        <p class="secret-reveal">The computer's secret code was: <%= game.secret_code.gsub(/\s*,\s*/, " ") %></p>
      <% end %>
    <% end %>
  <% else %>
    <p>No guesses yet.</p>
  <% end %>
</div>
